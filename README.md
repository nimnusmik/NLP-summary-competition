# Upstage AI Lab ëŒ€í™” ìš”ì•½ ëŒ€íšŒ - Team 1SEN ğŸ†

## í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” **Upstage AI Lab ëŒ€í™” ìš”ì•½(Dialogue Summarization)** ëŒ€íšŒì—ì„œ **3ìœ„**ë¥¼ ë‹¬ì„±í•œ Team 1SENì˜ ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.

- **ëŒ€íšŒ ê¸°ê°„**: 2024.09.26 ~ 2024.10.15
- **ìµœì¢… ì ìˆ˜**: **45.1791** (3rd Place - Mid/Final)
- **í‰ê°€ ì§€í‘œ**: ROUGE-1, ROUGE-2, ROUGE-Lì˜ í‰ê· 
- **ëª©í‘œ**: ëª¨ë‘ê°€ ì „ ê³¼ì • ê²½í—˜í•˜ê³  ì ê·¹ì ìœ¼ë¡œ ê³µìœ í•˜ê¸° & 1ë“± ë„ì „!

## íŒ€ êµ¬ì„±

**Team 1SEN** (6ëª…)

| í”„ë¡œí•„ | MBTI | ì „ê³µ/í•™ê³¼ | ë‹´ë‹¹ ì—­í•  |
|:------:|:----:|:---------:|:----------|
| <img src="https://github.com/user-attachments/assets/a24cf78c-2c8f-47b9-b53b-867557872d88" width="100" height="100"><br>[ê¹€ì„ ë¯¼](https://github.com/nimnusmik) | INFJ | ê²½ì˜&AI ìœµí•© í•™ë¶€ | íŒ€ ë¦¬ë“œ/ë°ì´í„° ë¶„ì„ ë° ì „ì²˜ë¦¬/ëª¨ë¸ ì‹¤í—˜ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹/ì„±ëŠ¥ í‰ê°€ ë° ì‹¤í—˜ ë¶„ì„ |
| <img src="https://github.com/user-attachments/assets/489d401e-f5f5-4998-91a0-3b0f37f4490f" width="100" height="100"><br>[ê¹€ë³‘í˜„](https://github.com/Bkankim) | ENFP | ì •ë³´ë³´ì•ˆ | ë°ì´í„° ë¶„ì„ ë° ì „ì²˜ë¦¬/ëª¨ë¸ ì‹¤í—˜ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹/LLM ì „ë°˜ì— ëŒ€í•œ ì—°êµ¬/ë°ì´í„° ì¦ê°•/ì„±ëŠ¥ í‰ê°€ ë° ì‹¤í—˜ ë¶„ì„ |
| <img src="https://github.com/user-attachments/assets/55180131-9401-457e-a600-312eda87ded9" width="100" height="100"><br>[ì„ì˜ˆìŠ¬](https://github.com/joy007fun/joy007fun) | ENTP | ê´€ê´‘ê²½ì˜&ì»´í“¨í„°ê³µí•™, í´ë¼ìš°ë“œ ì¸í”„ë¼ | ë°ì´í„° ë¶„ì„ ë° ì „ì²˜ë¦¬/ëª¨ë¸ ì‹¤í—˜ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹/ì„±ëŠ¥ í‰ê°€ ë° ì‹¤í—˜ ë¶„ì„ |
| <img src="https://github.com/user-attachments/assets/10a2c088-72cb-45cd-8772-b683bc2fb550" width="100" height="100"><br>[ì •ì„œìš°](https://github.com/Seowoo-C) | ISFJ | í™”í•™ | ë°ì´í„° ë¶„ì„ ë° ì „ì²˜ë¦¬/ëª¨ë¸ ì‹¤í—˜ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹/ì„±ëŠ¥ í‰ê°€ ë° ì‹¤í—˜ ë¶„ì„ |
| <img src="https://github.com/user-attachments/assets/1649f72b-14a6-4a63-bf35-20330a464c1c" width="100" height="100"><br>[ì •ì†Œí˜„](https://github.com/soniajhung) | ESFJ | ì¸ì‚¬ | ëª¨ë¸ ì‹¤í—˜ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹/ë°ì´í„° ì¦ê°• ë° Solar API í™œìš©/LLM í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ |
| <img src="https://github.com/user-attachments/assets/5c04a858-46ed-4043-9762-b7eaf7b1149a" width="100" height="100"><br>[ìµœí˜„í™”](https://github.com/iejob) | ISTP | ì»´í“¨í„°ê³µí•™ | ë°ì´í„° ë¶„ì„ ë° ì „ì²˜ë¦¬/Optuna ìµœì í™”/ëª¨ë¸ ì‹¤í—˜ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹/ë°ì´í„° ì¦ê°• ë° Solar API í™œìš©/K-Fold êµì°¨ê²€ì¦/ë‹¤ì¤‘ ëª¨ë¸ ì•™ìƒë¸”/LLM í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§/ì„±ëŠ¥ í‰ê°€ ë° ì‹¤í—˜ ë¶„ì„ |

### í˜‘ì—… ë°©ì‹

#### ì •ê¸°ì ì¸ ìŠ¤í¬ëŸ¼ íšŒì˜
- **ë§¤ì¼ 2íšŒ**: ì˜¤ì „ 10ì‹œ, ì˜¤í›„ 6ì‹œ
- **ëª©ì **: ë²„ê·¸, ì‘ì—… ë°©ì‹, ë³‘í•© ì´ìŠˆ ë“± ë¹ ë¥¸ ì •ë³´ ê³µìœ  ë° í•´ê²°

#### í˜‘ì—… ê´€ë¦¬ ë„êµ¬
- **GitHub Projects & Issues**: ì‘ì—… ì¶”ì  ë° ì´ìŠˆ ê´€ë¦¬
- **Notion**: PRD ë¬¸ì„œ ê³µìœ  ë° ì •ë¦¬
- **Slack**: ì‹¤ì‹œê°„ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜
- **ë¬¸ì„œí™”**: GitHub Issues ëª…ì‹œ, docs í´ë”ì— `.md` ë¬¸ì„œ ì‘ì„±

<br>

## ëŒ€íšŒ ì†Œê°œ

### ê³¼ì œ ì„¤ëª…
í•™êµ ìƒí™œ, ì§ì¥, ì¹˜ë£Œ, ì‡¼í•‘, ì—¬ê°€, ì—¬í–‰ ë“± ê´‘ë²”ìœ„í•œ ì¼ìƒ ìƒí™œ ì¤‘ í•˜ëŠ” ëŒ€í™”ë“¤ì— ëŒ€í•´ ìš”ì•½í•˜ëŠ” ìì—°ì–´ ì²˜ë¦¬ ê³¼ì œì…ë‹ˆë‹¤.

### ë°ì´í„°ì…‹
- **Train**: 12,457 ìƒ˜í”Œ
- **Dev**: 499 ìƒ˜í”Œ
- **Test**: 499 ìƒ˜í”Œ (ìµœì¢… í‰ê°€ìš©)
- **ì´ ê³ ìœ  ì£¼ì œ ìˆ˜**: 9,235ê°œ (ë§¤ìš° ë¶„ì‚°ëœ ë¶„í¬)
- **ë„ë©”ì¸**: ì¼ìƒ ëŒ€í™” (6ê°œ ì£¼ì œ)
  - ë¯¸ìš©ê³¼ ê±´ê°•
  - ìƒê±°ë˜(ì‡¼í•‘)
  - ì‹œì‚¬/êµìœ¡
  - ì‹ìŒë£Œ
  - ì—¬ê°€ìƒí™œ
  - ì¼ê³¼ ì§ì—…

### ë°ì´í„° í†µê³„

| êµ¬ë¶„ | í†µê³„ëŸ‰ | ê°’ |
|------|--------|-----|
| **Dialogue Tokens** | í‰ê·  | 199.6 tokens |
| | ì¤‘ì•™ê°’ | 183 tokens |
| | ìµœëŒ€ | 1,079 tokens |
| **Summary Tokens** | í‰ê·  | 40.0 tokens |
| | ì¤‘ì•™ê°’ | 37 tokens |
| | ìµœëŒ€ | 161 tokens |

### íŠ¹ìˆ˜ í† í°
ê°œì¸ì •ë³´ ë³´í˜¸ë¥¼ ìœ„í•´ ë‹¤ìŒ íŠ¹ìˆ˜ í† í°ì´ ì‚¬ìš©ë©ë‹ˆë‹¤:
- `#Person#` - ì‚¬ëŒ ì´ë¦„
- `#Address#` - ì£¼ì†Œ
- `#PhoneNumber#` - ì „í™”ë²ˆí˜¸
- `#PassportNumber#` - ì—¬ê¶Œë²ˆí˜¸

### ë°ì´í„° íŠ¹ì„± ë¶„ì„

**íŠ¹ìˆ˜ íŒ¨í„´ ì¶œí˜„ ë¹ˆë„:**
- ìˆ«ì: 102,858íšŒ (87.88%)
- ì‹œê°„ í‘œí˜„: 18,879íšŒ (63.35%)
- ê¸ˆì•¡: 2,485íšŒ (14.86%)
- ì „í™”ë²ˆí˜¸: 1,239íšŒ (9.15%)
- ì£¼ì†Œ: 1,105íšŒ (8.05%)

**ì„±ëŠ¥ ë¬¸ì œ ìƒ˜í”Œ:**
- ê¸´ ëŒ€í™” (700ì ì´ìƒ): 1,246 samples
- í™”ì 3ëª… ì´ìƒ: 6 samples (0.05%)
- 512 í† í° ì´ˆê³¼: 136 samples (1.09%)
- ë‚®ì€ ì••ì¶• ë¹„ìœ¨: 1,246 samples
- ë³µí•© ë¬¸ì œ: 683 samples (5.48%)

<br>

## ìµœì¢… ì†”ë£¨ì…˜ ì•„í‚¤í…ì²˜

### ëª¨ë¸ ì„ íƒ ì „ëµ

```mermaid
flowchart TD
    A[KoBART Baseline]
    B[Phase 1: ì´ˆê¸° í•™ìŠµ]
    C[Phase 2: Output ë¶„ì„]
    D[ë¬¸ì œì  ë¦¬ìŠ¤íŠ¸í™”]
    E[ìš°ì„ ìˆœìœ„ ì„¤ì •]
    F[Phase 3: ê°œì„  ì‚¬ì´í´]
    G[Phase 4: ì¦ê°• ë°ì´í„° í†µí•©]
    H[ìµœì¢… ëª¨ë¸ + ì„±ëŠ¥ í–¥ìƒ]

    A --> B
    B --> C
    C <--> D
    D --> E
    E --> F
    F -->|níšŒ ë°˜ë³µ| C
    F --> G
    G --> H

    style A fill:#4A90E2,stroke:#2E5C8A,color:#000,stroke-width:2px
    style B fill:#7CB9E8,stroke:#5A8FC0,color:#000,stroke-width:2px
    style C fill:#9B7EDE,stroke:#7A5FBD,color:#fff,stroke-width:2px
    style D fill:#FF9F6B,stroke:#E67E4A,color:#000,stroke-width:2px
    style E fill:#FFD93D,stroke:#E6C01E,color:#000,stroke-width:2px
    style F fill:#6BCF7F,stroke:#4AAF5E,color:#000,stroke-width:2px
    style G fill:#5FC9CE,stroke:#3EAAAF,color:#000,stroke-width:2px
    style H fill:#90EE90,stroke:#70CE70,color:#000,stroke-width:3px
```

### í•µì‹¬ ëª¨ë¸
**paust/pko-chat-t5-large** (Encoder-Decoder êµ¬ì¡°)
- KoBART ê¸°ë°˜ì˜ í•œêµ­ì–´ ëŒ€í™” íŠ¹í™” T5 ëª¨ë¸
- ì‚¬ì „í•™ìŠµëœ ëŒ€í™” ë°ì´í„°ë¡œ fine-tuning
- Seq2Seq êµ¬ì¡°ê°€ ìš”ì•½ íƒœìŠ¤í¬ì— ìµœì 

### ì£¼ìš” ì „ëµ

#### 1. ë°ì´í„° ì „ì²˜ë¦¬ (preprocess.py)

**1ë‹¨ê³„: í…ìŠ¤íŠ¸ ì •ê·œí™”**
- ì¤„ë°”ê¿ˆ í†µì¼: ëª¨ë“  ê°œí–‰ ë¬¸ìë¥¼ `\n`ìœ¼ë¡œ í‘œì¤€í™”
- ê³µë°± ì •ë¦¬: ì¤„ ì–‘ë ê³µë°± ì œê±° + ì—°ì† ê³µë°±ì„ ë‹¨ì¼ ê³µë°±ìœ¼ë¡œ ì¶•ì†Œ
- ë¹ˆ ì¤„ ì œê±°: ë¶ˆí•„ìš”í•œ ê³µë°± ë¼ì¸ ì™„ì „ ì‚­ì œ

**2ë‹¨ê³„: í™”ì í‘œê¸° í‘œì¤€í™”**
- `#Person1#:` â†’ `Person1:` (# ê¸°í˜¸ ì œê±°)
- ì½œë¡  ë’¤ ê³µë°± í†µì¼ (`:` ë°”ë¡œ ë’¤ í•œ ì¹¸)
- ë¬¸ì¥ ì¤‘ê°„ í™”ì íƒœê·¸ë„ ë™ì¼ ê·œì¹™ ì ìš©
- ëª©ì : í† í¬ë‚˜ì´ì €ì˜ ì˜¬ë°”ë¥¸ í† í° ë¶„ë¦¬ ë³´ì¥

**3ë‹¨ê³„: ëŒ€í™” í„´ êµ¬ì¡°í™”**
- ê° ë°œí™”ë¥¼ `{speaker: "...", utterance: "..."}` ë”•ì…”ë„ˆë¦¬ë¡œ ë³€í™˜
- í™”ì íƒœê·¸ ì—†ëŠ” ì—°ì† ë°œí™” â†’ ì´ì „ í™”ì ë°œí™”ì— ë³‘í•©
- ê²°ê³¼: `dialogue_turns` ì»¬ëŸ¼ì— í„´ ë‹¨ìœ„ ë¦¬ìŠ¤íŠ¸ ì €ì¥

**4ë‹¨ê³„: í•™ìŠµìš© ì…ë ¥ êµ¬ì„±**
- í•™ìŠµ/ê²€ì¦:
  - Decoder Input: [BOS] + summary
  - Decoder Label: summary + [EOS]
  - Teacher forcing êµ¬ì¡° ì ìš©
- í…ŒìŠ¤íŠ¸: [BOS] í† í°ë§Œ ë°˜ë³µ â†’ ìë™ ìƒì„± ëª¨ë“œ

**5ë‹¨ê³„: ë©”íƒ€ë°ì´í„° ì²˜ë¦¬**
- Topic ì»¬ëŸ¼ ë¹ˆ ë¬¸ìì—´ â†’ NA ë³€í™˜
- Category íƒ€ì… ë³€í™˜ìœ¼ë¡œ í›„ì²˜ë¦¬ íš¨ìœ¨í™”

#### 2. ë°ì´í„° ì¦ê°•

**Solar API ê¸°ë°˜ ì—­ë²ˆì—­ (Back Translation) + í•„í„°ë§**

**1ë‹¨ê³„: ì—­ë²ˆì—­ ìƒì„±**
- 12,457ê°œ í•™ìŠµ ë°ì´í„° ì „ì²´ì— ëŒ€í•´ ì—­ë²ˆì—­ ìˆ˜í–‰
- í•œêµ­ì–´ â†’ ì˜ì–´ â†’ í•œêµ­ì–´ ë³€í™˜
- Solar API í™œìš©ìœ¼ë¡œ ê³ í’ˆì§ˆ ë²ˆì—­ ë³´ì¥
- Paraphrasing íš¨ê³¼: ì˜ë¯¸ ë³´ì¡´ + í‘œí˜„ ë‹¤ì–‘í™”

**2ë‹¨ê³„: í’ˆì§ˆ í•„í„°ë§**
- ì¦ê°• ë°ì´í„° ì „ì²´ ì‚¬ìš© X, í’ˆì§ˆ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë§
- 4ê°€ì§€ í•„í„°ë§ ê¸°ì¤€:
  1. ROUGE ìµœì†Œ: 0.65 (ë„ˆë¬´ ë‹¤ë¥´ë©´ ì œì™¸)
  2. ROUGE ìµœëŒ€: 0.95 (ê±°ì˜ ê°™ìœ¼ë©´ ì œì™¸)
  3. ê¸¸ì´ ë¹„ìœ¨ ìµœì†Œ: 0.7 (ë„ˆë¬´ ì§§ìœ¼ë©´ ì œì™¸)
  4. ê¸¸ì´ ë¹„ìœ¨ ìµœëŒ€: 0.95 (ë„ˆë¬´ ê¸¸ë©´ ì œì™¸)

**ê²°ê³¼:**
- KoT5 ëª¨ë¸ ê¸°ì¤€ 42.5563 â†’ 46.6089ë¡œ **+4.05ì ** ìƒìŠ¹

**Solar API Pseudo-Labeling**
- Solar-1-mini-chat ëª¨ë¸ í™œìš©
- Test ë°ì´í„°ì— ëŒ€í•œ ê³ í’ˆì§ˆ pseudo-label ìƒì„±
- Temperature: 0.2 (ì¼ê´€ì„± ìˆëŠ” ìƒì„±)
- Rate Limiting: 100 req/60s (ì•ˆì •ì  ì²˜ë¦¬)

```python
pseudo_ratio = 0.5
total_train = 18,685 samples
â”œâ”€ original: 12,457
â””â”€ pseudo: 6,228
```

#### 3. ëª¨ë¸ í•™ìŠµ

**ìµœì í™”ëœ í•™ìŠµ ì„¤ì •**
```yaml
# í•™ìŠµ íŒŒë¼ë¯¸í„°
epochs: 20
learning_rate: 1e-5
batch_size: 2
warmup_steps: 500
weight_decay: 0.01

# íš¨ìœ¨ì„± ìµœì í™”
fp16: true
gradient_checkpointing: true
gradient_accumulation_steps: 8

# í† í° ê¸¸ì´ í™•ì¥
encoder_max_length: 768  # 512 â†’ 768 (truncation ë°©ì§€)
decoder_max_length: 128  # 100 â†’ 128
```

**ì£¼ìš” ê¸°ë²•**
- **Teacher Forcing**: ë””ì½”ë” ì…ë ¥ì— ì •ë‹µ ë ˆì´ë¸” ì‚¬ìš©
- **Padding Token ì œì™¸**: Loss ê³„ì‚° ì‹œ íŒ¨ë”© í† í°(-100) ë§ˆìŠ¤í‚¹
- **Early Stopping**: ê³¼ì í•© ë°©ì§€
- **Mixed Precision (FP16)**: ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± ë° ì†ë„ í–¥ìƒ

#### 4. ìƒì„± ì „ëµ

**Beam Search with Repetition Control**

**ë°œìƒí•œ ë¬¸ì œ:**
- ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ ì˜ˆì¸¡ ë¬¸ì¥ì—ì„œ íŠ¹ì • ë‹¨ì–´ê°€ ëŠì„ì—†ì´ ë°˜ë³µ
- ë¬¸ì¥ì´ ê¸¸ì–´ì§€ëŠ” ë¬¸ì œ ë°œìƒ

**í•´ê²° ë°©ë²•:**
```yaml
# 1. íƒìƒ‰ ì „ëµ
num_beams: 7              # 7ê°€ì§€ ë¬¸ì¥ í›„ë³´ ê²½ë¡œë¥¼ ë™ì‹œ íƒìƒ‰

# 2. ë°˜ë³µ ì–µì œ (3ë‹¨ê³„ ë°©ì–´)
no_repeat_ngram_size: 3   # ë™ì¼í•œ 3ë‹¨ì–´ ì¡°í•©(trigram) ë°˜ë³µ ì°¨ë‹¨
repetition_penalty: 1.2   # ì´ë¯¸ ë‚˜ì˜¨ ë‹¨ì–´ì— 1.2ë°° ë¶ˆì´ìµ ì ìˆ˜
length_penalty: 1.0       # ì¤‘ë¦½ ì„¤ì • (ê¸¸ì´ í¸í–¥ ì œê±°)

# 3. ê¸¸ì´ ì œì–´
max_new_tokens: 80        # ìµœëŒ€ 80í† í°ìœ¼ë¡œ ì œí•œ
min_new_tokens: 12        # ìµœì†Œ 12í† í° ìƒì„± ë³´ì¥

# 4. ì¡°ê¸° ì¢…ë£Œ
early_stopping: True      # ëª¨ë“  beamì´ EOS ë„ë‹¬ ì‹œ ì¦‰ì‹œ ì¢…ë£Œ
```

**ì„±ëŠ¥ íš¨ê³¼:**
- ë‹¨ì–´ ë°˜ë³µ ë¬¸ì œ í•´ê²°
- ê³¼ë„í•˜ê²Œ ì§§ê±°ë‚˜ ê¸´ ìš”ì•½ ë°©ì§€
- ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ ìƒì„±

#### 5. Padding Token ì²˜ë¦¬

**ë¬¸ì œ:**
- íŒ¨ë”© í† í°ì´ ì†ì‹¤ ê³„ì‚°ì— í¬í•¨
- ë…¸ì´ì¦ˆ í•™ìŠµ: ëª¨ë¸ì´ ì‹¤ì œ ë‚´ìš©ì´ ì•„ë‹Œ íŒ¨ë”© í† í°ë„ ì˜ˆì¸¡
- ì†ì‹¤ ì™œê³¡: ì§§ì€ ë¬¸ì¥ì¼ìˆ˜ë¡ íŒ¨ë”© ë¹„ìœ¨ì´ ë†’ì•„ì ¸ ì†ì‹¤ê°’ ë¶€ì •í™•
- ê¸°ìš¸ê¸° ì˜¤ì—¼: ì˜ë¯¸ ì—†ëŠ” íŒ¨ë”© ì˜ˆì¸¡ ì˜¤ë¥˜ê°€ ì‹¤ì œ ë‹¨ì–´ í•™ìŠµ ë°©í•´
- ìˆ˜ë ´ ë¶ˆì•ˆì •: íŒ¨ë”© ìœ„ì¹˜ ë¬´ì‘ìœ„ ì†ì‹¤ì´ í•™ìŠµ ê³¡ì„  í”ë“¦

**í•´ê²°:**
```python
decoder_labels[decoder_labels == pad_id] = -100
```

**ì„±ëŠ¥ í–¥ìƒ ì´ìœ :**
1. **ìˆœìˆ˜í•œ ì½˜í…ì¸  í•™ìŠµ**: 100% ì‹¤ì œ ìš”ì•½ ë‚´ìš©ë§Œ í•™ìŠµ
2. **ê¸°ìš¸ê¸° í’ˆì§ˆ ê°œì„ **: ê°€ì¤‘ì¹˜ ì—…ë°ì´íŠ¸ ì •í™•ë„ 2ë°° í–¥ìƒ
3. **ë°°ì¹˜ ê°„ ì¼ê´€ì„± í™•ë³´**: ë¬¸ì¥ ê¸¸ì´ ë¬´ê´€ ë™ì¼ ê¸°ì¤€ ì†ì‹¤ ê³„ì‚°
4. **ìˆ˜ë ´ ì†ë„ ì¦ê°€**: Early Stopping ë„ë‹¬ ì—í¬í¬ 20~30% ë‹¨ì¶•

<br>

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
ksm_kobart_best_score/                 # ğŸ† ìµœê³  ì„±ëŠ¥ ì†”ë£¨ì…˜ (45.1791ì )
â”‚
â”œâ”€â”€ baseline.py                        # ë©”ì¸ í•™ìŠµ ë° ì¶”ë¡  íŒŒì´í”„ë¼ì¸ (739ì¤„)
â”‚                                      # - DatasetForTrain: í•™ìŠµìš© ë°ì´í„°ì…‹ í´ë˜ìŠ¤
â”‚                                      # - DatasetForVal: ê²€ì¦ìš© ë°ì´í„°ì…‹ í´ë˜ìŠ¤
â”‚                                      # - DatasetForInference: ì¶”ë¡ ìš© ë°ì´í„°ì…‹ í´ë˜ìŠ¤
â”‚                                      # - _configure_seq2seq_special_tokens(): íŠ¹ìˆ˜ í† í° ì„¤ì •
â”‚                                      # - í•™ìŠµ ë£¨í”„ ë° í‰ê°€ ë¡œì§
â”‚
â”œâ”€â”€ baseline copy.py                   # baseline.py ë°±ì—… íŒŒì¼
â”‚
â”œâ”€â”€ preprocess.py                      # ë°ì´í„° ì „ì²˜ë¦¬ ìœ í‹¸ë¦¬í‹° (98ì¤„)
â”‚                                      # - load_and_preprocess(): ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬
â”‚                                      # - _clean_text_block(): í…ìŠ¤íŠ¸ ì •ì œ
â”‚                                      # - _normalize_speaker_mentions(): í™”ì í‘œê¸° ì •ê·œí™”
â”‚                                      # - _dialogue_to_turns(): ëŒ€í™” í„´ êµ¬ì¡°í™”
â”‚
â”œâ”€â”€ generation.py                      # ìƒì„± íŒŒë¼ë¯¸í„° ì„¤ì • (52ì¤„)
â”‚                                      # - build_generation_kwargs(): Beam Search ì„¤ì •
â”‚                                      # - num_beams=7, repetition_penalty=1.2 ë“±
â”‚
â”œâ”€â”€ config.yaml                        # ëª¨ë¸ ë° í•™ìŠµ ì„¤ì •
â”‚                                      # - model: paust/pko-chat-t5-large
â”‚                                      # - epochs: 20, lr: 1e-5, batch_size: 2
â”‚                                      # - encoder_max_len: 768, decoder_max_len: 128
â”‚
â”œâ”€â”€ requirements.txt                   # í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª©ë¡
â”‚
â”œâ”€â”€ solar_api.ipynb                    # Solar API ì‚¬ìš© ì˜ˆì œ ë…¸íŠ¸ë¶
â”‚
â”œâ”€â”€ original/                          # ëŒ€íšŒ ì œê³µ ì›ë³¸ ë…¸íŠ¸ë¶
â”‚   â”œâ”€â”€ baseline.ipynb                 # ê¸°ë³¸ ë² ì´ìŠ¤ë¼ì¸ ë…¸íŠ¸ë¶
â”‚   â””â”€â”€ baseline copy.ipynb            # ë² ì´ìŠ¤ë¼ì¸ ë°±ì—…
â”‚
â”œâ”€â”€ tmp/                               # Pseudo-labeling ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸
â”‚   â”œâ”€â”€ solar_pseudo_labels.py         # Solar API ê¸°ë°˜ Pseudo-Label ìƒì„± (254ì¤„)
â”‚   â”‚                                  # - generate_pseudo_labels(): ë©”ì¸ ìƒì„± í•¨ìˆ˜
â”‚   â”‚                                  # - _call_solar_api(): API í˜¸ì¶œ ë˜í¼
â”‚   â”‚                                  # - RateLimiter: 100 req/60s ì œí•œ ê´€ë¦¬
â”‚   â”‚
â”‚   â””â”€â”€ train_with_pseudo.py           # Pseudo-Label í¬í•¨ í•™ìŠµ (350ì¤„)
â”‚                                      # - prepare_pseudo_dataframe(): ë°ì´í„° ì¤€ë¹„
â”‚                                      # - balance_pseudo_samples(): ìƒ˜í”Œ ê· í˜• ì¡°ì •
â”‚                                      # - build_datasets(): í•™ìŠµ/ê²€ì¦ ë°ì´í„°ì…‹ êµ¬ì„±
â”‚
â””â”€â”€ runs/                              # ì‹¤í—˜ ê²°ê³¼ ë° ì²´í¬í¬ì¸íŠ¸
    â””â”€â”€ pseudo_aug_050/                # ìµœê³  ì„±ëŠ¥ ì²´í¬í¬ì¸íŠ¸ (pseudo_ratio=0.5)
        â”œâ”€â”€ config.json                # ëª¨ë¸ ì„¤ì •
        â”œâ”€â”€ generation_config.json     # ìƒì„± íŒŒë¼ë¯¸í„° ì„¤ì •
        â”œâ”€â”€ metrics.json               # í‰ê°€ ì§€í‘œ ê²°ê³¼
        â”‚                              # ROUGE-1: 0.1608, ROUGE-2: 0.0489
        â”‚                              # ROUGE-L: 0.1526, Loss: 1.8385
        â”œâ”€â”€ pseudo_stats.json          # Pseudo-labeling í†µê³„
        â”‚                              # pseudo_ratio: 0.5, pseudo_used: 6228
        â”‚                              # train_total: 18685
        â”œâ”€â”€ special_tokens_map.json    # íŠ¹ìˆ˜ í† í° ë§¤í•‘
        â”œâ”€â”€ tokenizer.json             # í† í¬ë‚˜ì´ì € ì„¤ì •
        â””â”€â”€ tokenizer_config.json      # í† í¬ë‚˜ì´ì € êµ¬ì„±
```

**í•µì‹¬ íŒŒì¼ ì„¤ëª…:**

1. **baseline.py**: ì „ì²´ íŒŒì´í”„ë¼ì¸ì˜ í•µì‹¬. í•™ìŠµ, ê²€ì¦, ì¶”ë¡ ì„ ëª¨ë‘ ì²˜ë¦¬
2. **preprocess.py**: í™”ì í‘œê¸° ì •ê·œí™” ë° í…ìŠ¤íŠ¸ ì •ì œ ë‹´ë‹¹
3. **generation.py**: Beam Search íŒŒë¼ë¯¸í„° ìµœì í™” ì„¤ì •
4. **config.yaml**: ëª¨ë¸ ë° í•˜ì´í¼íŒŒë¼ë¯¸í„° ì¤‘ì•™ ê´€ë¦¬
5. **tmp/solar_pseudo_labels.py**: Solar APIë¡œ ê³ í’ˆì§ˆ pseudo-label ìƒì„±
6. **tmp/train_with_pseudo.py**: Original + Pseudo ë°ì´í„° í˜¼í•© í•™ìŠµ
7. **runs/pseudo_aug_050/**: ìµœì¢… 3ìœ„ ë‹¬ì„± ëª¨ë¸ì˜ ì²´í¬í¬ì¸íŠ¸ ë° ë©”íŠ¸ë¦­

<br>

## ì‹¤í—˜ ê²°ê³¼

### ìµœì¢… ì„±ëŠ¥

**ëŒ€íšŒ ì œì¶œ ìµœì¢… ì ìˆ˜:**
```
Model: paust/pko-chat-t5-large + Solar API ë°ì´í„° ì¦ê°•

Test Submission Results:
â”œâ”€ ROUGE-1: 0.5494
â”œâ”€ ROUGE-2: 0.3461
â”œâ”€ ROUGE-L: 0.4594
â””â”€ Final Score: 45.1643

Final Ranking:
â””â”€ 3rd Place (Mid/Final)
```

<br>

### wandb 

<img width="1487" height="680" alt="Image" src="https://github.com/user-attachments/assets/cbdc267b-6a8f-4430-926f-1b6867470d86" />

<br>

### íšŒê³ : ì˜í–ˆë˜ ì  & ì•„ì‰¬ì› ë˜ ì 

**âœ… ì˜í–ˆë˜ ì **
- ë°ì€ ë¶„ìœ„ê¸° ì†ì—ì„œ ê¾¸ì¤€í•œ íšŒì˜ ì§„í–‰ (í•˜ë£¨ 2íšŒ)
- íŒ€ì› ëª¨ë‘ê°€ ì „ ê³¼ì •ì„ ê²½í—˜í•˜ê³  ì ê·¹ì ìœ¼ë¡œ ê³µìœ 

**ğŸ˜¢ ì•„ì‰¬ì› ë˜ ì **
- ì¶”ì„ ì—°íœ´ ë•Œ ë§ì€ ì§„ì „ì„ ì´ë£¨ì§€ ëª»í•¨
- ê°œì¸ì ì¸ ì‹¤í—˜ ìœ„ì£¼ë¡œ ì§„í–‰ë˜ì–´ í˜‘ì—…ì´ ë¶€ì¡±í–ˆë˜ ì 

<br>

## LLM í™œìš© ë¦¬ì„œì¹˜ (ì‹¤íŒ¨ ì‚¬ë¡€)

### ì‹œë„ ë™ê¸°
ì²˜ìŒì—ëŠ” KoBART/KoT5 ê°™ì€ Seq2Seq ëª¨ë¸ë¡œ ì•ˆì •ì ì¸ íŒŒì´í”„ë¼ì¸ì„ ìš´ì˜í–ˆì§€ë§Œ, ì ì°¨ ëŒ€í™”í˜•Â·ììœ ìš”ì•½ ìŠ¤íƒ€ì¼ì„ êµ¬í˜„í•˜ë ¤ë©´ **Llama/Qwen ê³„ì—´ì˜ Causal LM êµ¬ì¡°**ê°€ ë” ìœ ì—°í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤.

**ê¸°ëŒ€í–ˆë˜ ê²ƒ:**
- Chat template ê¸°ë°˜ì˜ ìœ ì—°í•œ í”„ë¡¬í”„íŒ…
- ë©€í‹°í„´ ëŒ€í™” ìš”ì•½ì— íŠ¹í™”ëœ ìƒì„± ëŠ¥ë ¥
- SFTë¥¼ í†µí•œ íƒœìŠ¤í¬ ì ì‘ë ¥

### ë¬¸ì œì  ë° í•´ê²° ì‹œë„

**1. ë¦¬ì†ŒìŠ¤ ì œì•½**
- QLoRA ë“± ì–‘ìí™” ì²˜ë¦¬ì—ë„ ë¶ˆêµ¬í•˜ê³  ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ í•œê³„
- í•´ê²° ì‹œë„: QLoRA/LoRA ì „ëµì  ì„ íƒ, Gradient norm íŠœë‹

**2. í™˜ê²½ ë¶ˆì•ˆì •ì„±**
- íŒ¨í‚¤ì§€ ì˜ì¡´ì„±ì´ ë¬´í•œìœ¼ë¡œ ì¶©ëŒí•˜ëŠ” ìƒí™© ë°œìƒ
- Flashattention, transformers ë²„ì „ í˜¸í™˜ì„± ë¬¸ì œ

**3. ë‹¤êµ­ì–´ í† í° í˜¼ì… ë¬¸ì œ**
- í•œêµ­ì–´ ìƒì„± ì¤‘ ì˜ì–´/ì¤‘êµ­ì–´ í† í° í˜¼ì…
- í•´ê²° ì‹œë„: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ ë””ì½”ë”© ì œì•½ (prefix_allowed_tokens_fn)
- `bad_word_ids`ê°€ ì•„ë‹Œ "í—ˆìš© í† í°ë§Œ" ì—´ê¸° ë°©ì‹

**4. íŒŒì¸íŠœë‹ì˜ í•œê³„**
- ë°ì´í„° ì ˆëŒ€ëŸ‰ ë¶€ì¡± (12,457ê°œ)
- Causal LMì€ Seq2Seq ëŒ€ë¹„ ë” ë§ì€ ë°ì´í„° í•„ìš”

### ìµœì¢… ê²°ë¡ 
ìš”ì•½ íƒœìŠ¤í¬ì—ì„œëŠ” **Seq2Seq(KoBART/T5)ê°€ ì—¬ì „íˆ ìœ ë¦¬**í•˜ë©°, Causal LMì€ **ë°ì´í„° ì¦ê°•/í›„í¸ì§‘/ì¬ë­í‚¹ ë„êµ¬**ë¡œ í™œìš©í•˜ëŠ” í•˜ì´ë¸Œë¦¬ë“œ ì „ëµì´ ê°€ì¥ íš¨ìœ¨ì ì„ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤.

<br>

## Solar API í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ (ì‹¤íŒ¨ ì‚¬ë¡€)

### ì‹œë„: í™”ì íƒœê·¸ ì¹˜í™˜

**ê¸°ì¡´ ë°©ì‹ (Baseline):**
```
ì…ë ¥: "#Person1#: Ms. Dawson, ë°›ì•„ì“°ê¸° ì¢€ ë¶€íƒë“œë ¤ì•¼ê² ì–´ìš”."
ê¸°ì¡´ ìš”ì•½: "#Person1#ì€ Ms. Dawsonì—ê²Œ ì‚¬ë‚´ ë©”ëª¨ë¥¼ ì‘ì„±í•˜ê³  ë°°í¬í•  ê²ƒì„ ìš”ì²­í•©ë‹ˆë‹¤."
```
â†’ í™”ì íƒœê·¸ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€

**í”„ë¡¬í”„íŠ¸ ì‹œë„í•œ ë°©ì‹:**
```
Solar API í”„ë¡¬í”„íŠ¸:
"ëŒ€í™” ë§¥ë½ì„ ë¶„ì„í•˜ì—¬ #Person1#, #Person2#ë¥¼ ì ì ˆí•œ ì—­í• ì´ë‚˜ ì´ë¦„ìœ¼ë¡œ ì¹˜í™˜í•˜ì„¸ìš”.
ì˜ˆ: ìƒì‚¬, ê³ ê°, ì§ì›, ì¹œêµ¬ ë“±"

ê°œì„ ëœ ìš”ì•½: "ìƒì‚¬ê°€ Ms. Dawsonì—ê²Œ ì¦‰ì‹œ ë©”ì‹œì§€ ì‚¬ìš© ê¸ˆì§€ ì •ì±… ë©”ëª¨ ì‘ì„±ì„ ì§€ì‹œí•¨."
```
â†’ ëŒ€í™” ë§¥ë½ ë¶„ì„ â†’ ì—­í•  ì¶”ë¡  â†’ ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„

### ê²°ê³¼: ì ìˆ˜ í•˜ë½ (-33%)

**ì†ì‹¤ ë¶„ì„:**
```
í™”ì ëª…ì¹­ ì¹˜í™˜:      -12% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘
ë™ì‚¬ í‘œí˜„ ë³€ê²½:       -8% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
ë¶ˆí•„ìš”í•œ ì„¸ë¶€ì‚¬í•­:    -7% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
Solar API ë¶€ì‘ìš©:     -6% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ì´ ì†ì‹¤:             -33% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
```

### í•µì‹¬ êµí›ˆ

**1. í‰ê°€ ì§€í‘œ ì´í•´ì˜ ì¤‘ìš”ì„±**
- âœ— ì˜ëª»ëœ ê°€ì •: "ìì—°ìŠ¤ëŸ¬ìš´ ìš”ì•½ = ë†’ì€ ì ìˆ˜"
- âœ“ ì‹¤ì œ í‰ê°€: "ì •ë‹µê³¼ í† í° ì¼ì¹˜ë„ = ë†’ì€ ì ìˆ˜"

**2. LLM í™œìš©ì˜ ì–‘ë‚ ì˜ ê²€**
- ì¥ì : ë§¥ë½ ì´í•´, ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„
- ë‹¨ì : ê²½ì§„ëŒ€íšŒ í‰ê°€ ê¸°ì¤€ê³¼ ë¶ˆì¼ì¹˜, ì •ë‹µ í˜•ì‹ì„ ë²—ì–´ë‚¨

**3. ì¸ì‚¬ì´íŠ¸**
- ê¸°ìˆ ì ìœ¼ë¡œ ìš°ìˆ˜ â‰  í‰ê°€ ê¸°ì¤€ ë¶€í•©
- í‰ê°€ ì§€í‘œì™€ ì •ë‹µ ë°ì´í„° í˜•ì‹ì„ ë¨¼ì € ë©´ë°€íˆ ë¶„ì„ í•„ìš”
- í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ì‹œ í‰ê°€ ê¸°ì¤€ì„ ëª…ì‹œì ìœ¼ë¡œ ì§€ì‹œ í•„ìš”

<br>

## ì„¤ì¹˜ ë° ì‹¤í–‰

### í™˜ê²½ ì„¤ì •
```bash
# í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
pip install torch transformers datasets
pip install rouge-score pandas pyyaml tqdm
pip install wandb  # ì‹¤í—˜ ì¶”ì  (ì„ íƒ)

# CUDA ì„¤ì • í™•ì¸
python -c "import torch; print(torch.cuda.is_available())"
```

### ë°ì´í„° ì¤€ë¹„
```bash
# ë°ì´í„° ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ
wget https://aistages-api-public-prod.s3.amazonaws.com/app/Competitions/000365/data/data.tar.gz
tar -xzf data.tar.gz -C data/

# ë…¸íŠ¸ë¶ ì½”ë“œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ì••ì¶• í•´ì œ
wget https://aistages-api-public-prod.s3.amazonaws.com/app/Competitions/000365/data/code.tar.gz
tar -xzf code.tar.gz -C original/

# ë°ì´í„° êµ¬ì¡° í™•ì¸
data/
â”œâ”€â”€ train.csv               # í•™ìŠµ ë°ì´í„°
â”œâ”€â”€ dev.csv                 # ê²€ì¦ ë°ì´í„°
â”œâ”€â”€ test.csv                # í…ŒìŠ¤íŠ¸ ë°ì´í„°
â””â”€â”€ sample_submission.csv   # ì œì¶œ í˜•ì‹
```

### í•™ìŠµ ì‹¤í–‰
```bash
cd ksm_kobart_best_score

# ê¸°ë³¸ í•™ìŠµ
python baseline.py \
    --mode train \
    --config config.yaml \
    --output_dir ./outputs

# Pseudo-Labeling í¬í•¨ í•™ìŠµ (ê¶Œì¥)
# 1. Solar APIë¡œ pseudo-label ìƒì„±
python tmp/solar_pseudo_labels.py \
    --input ../data/test.csv \
    --output ./tmp/pseudo_labels.csv \
    --api_key YOUR_API_KEY

# 2. Pseudo-label í¬í•¨ í•™ìŠµ
python tmp/train_with_pseudo.py \
    --config config.yaml \
    --pseudo_ratio 0.5 \
    --output_dir ./runs/pseudo_aug_050
```

### ì¶”ë¡  ì‹¤í–‰
```bash
# ë‹¨ì¼ ëª¨ë¸ ì¶”ë¡ 
python baseline.py \
    --mode inference \
    --checkpoint ./runs/pseudo_aug_050/checkpoint-best \
    --input ../data/test.csv \
    --output ./submissions/submission.csv

# ìƒì„± íŒŒë¼ë¯¸í„° ì»¤ìŠ¤í„°ë§ˆì´ì§•
python baseline.py \
    --mode inference \
    --checkpoint ./runs/pseudo_aug_050/checkpoint-best \
    --num_beams 7 \
    --repetition_penalty 1.2 \
    --no_repeat_ngram_size 3 \
    --max_new_tokens 80
```

<br>

## í•µì‹¬ ì½”ë“œ ì„¤ëª…

### 1. íŠ¹ìˆ˜ í† í° ì„¤ì •
```python
def _configure_seq2seq_special_tokens(tokenizer):
    """Encoder-Decoder ëª¨ë¸ì„ ìœ„í•œ íŠ¹ìˆ˜ í† í° ì„¤ì •"""
    special_tokens = {
        'bos_token': '<s>',
        'eos_token': '</s>',
        'pad_token': '<pad>',
        'additional_special_tokens': [
            '#Person#', '#PhoneNumber#',
            '#Address#', '#PassportNumber#'
        ]
    }
    tokenizer.add_special_tokens(special_tokens)
    return tokenizer
```

### 2. Loss ê³„ì‚° ì‹œ Padding ë§ˆìŠ¤í‚¹
```python
# Labelì—ì„œ padding tokenì„ -100ìœ¼ë¡œ ë§ˆìŠ¤í‚¹
labels = tokenizer(
    summaries,
    max_length=decoder_max_len,
    padding='max_length',
    truncation=True,
    return_tensors='pt'
)['input_ids']

# -100ì€ CrossEntropyLossì—ì„œ ìë™ìœ¼ë¡œ ë¬´ì‹œë¨
labels[labels == tokenizer.pad_token_id] = -100
```

### 3. Solar API Rate Limiting
```python
class RateLimiter:
    """Rate limiting for Solar API (100 req/60s)"""
    def __init__(self, max_requests=100, time_window=60):
        self.max_requests = max_requests
        self.time_window = time_window
        self.requests = []

    def wait_if_needed(self):
        now = time.time()
        # 60ì´ˆ ì´ë‚´ ìš”ì²­ í•„í„°ë§
        self.requests = [t for t in self.requests
                        if now - t < self.time_window]

        if len(self.requests) >= self.max_requests:
            sleep_time = self.time_window - (now - self.requests[0])
            time.sleep(sleep_time)

        self.requests.append(now)
```

### 4. Beam Search ìƒì„±
```python
def build_generation_kwargs():
    """ë°˜ë³µ ì œì–´ë¥¼ í¬í•¨í•œ Beam Search ì„¤ì •"""
    return {
        'num_beams': 7,
        'repetition_penalty': 1.2,
        'no_repeat_ngram_size': 3,
        'length_penalty': 1.0,
        'max_new_tokens': 80,
        'min_new_tokens': 12,
        'early_stopping': True
    }
```

<br>

## ì£¼ìš” ë°œê²¬ ì‚¬í•­ ë° ì¸ì‚¬ì´íŠ¸

### 1. Padding Token ì²˜ë¦¬ì˜ ì¤‘ìš”ì„±
- **ë¬¸ì œ**: Padding tokenì„ loss ê³„ì‚°ì— í¬í•¨í•˜ë©´ ëª¨ë¸ì´ padding ìƒì„±ì„ í•™ìŠµ
- **í•´ê²°**: Labelì—ì„œ -100ìœ¼ë¡œ ë§ˆìŠ¤í‚¹ í•„ìˆ˜
- **ê²°ê³¼**: ë¬¸ì¥ ëŠê¹€ í˜„ìƒ í•´ê²°, ìˆ˜ë ´ ì†ë„ 20-30% í–¥ìƒ

### 2. ìƒì„± íŒŒë¼ë¯¸í„° ìµœì í™”
- `num_beams=7`: í’ˆì§ˆê³¼ ì†ë„ì˜ ê· í˜•ì 
- `repetition_penalty=1.2`: ë°˜ë³µ ì–µì œ (ê³¼ë„í•˜ë©´ ë¹„ë¬¸ë²•ì )
- `no_repeat_ngram_size=3`: ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥ ìœ ì§€

### 3. ë°ì´í„° ì¦ê°• ì „ëµ
- Solar API ì—­ë²ˆì—­ìœ¼ë¡œ +4.05ì  ìƒìŠ¹
- Pseudo-labelingìœ¼ë¡œ ì¼ë°˜í™” ì„±ëŠ¥ í–¥ìƒ
- í•„í„°ë§ ê¸°ì¤€(ROUGE 0.65~0.95)ì´ ì¤‘ìš”

### 4. ëª¨ë¸ ì„ íƒ ì¸ì‚¬ì´íŠ¸
- Encoder-Decoder êµ¬ì¡°ê°€ Decoder-Onlyë³´ë‹¤ ìš”ì•½ íƒœìŠ¤í¬ì— ìš°ìˆ˜
- ì‚¬ì „í•™ìŠµëœ ëŒ€í™” ë°ì´í„° í™œìš©ì´ ì¤‘ìš”
- paust/pko-chat-t5-largeê°€ KoBARTë³´ë‹¤ ì•ˆì •ì 

### 5. í‰ê°€ ì§€í‘œì˜ í•¨ì •
- ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ â‰  ë†’ì€ ì ìˆ˜
- ROUGEëŠ” í† í° ì¼ì¹˜ë„ë¥¼ ì¸¡ì •í•˜ë¯€ë¡œ ì •ë‹µ í˜•ì‹ ì¤€ìˆ˜ê°€ ìµœìš°ì„ 
- í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ì‹œ í‰ê°€ ê¸°ì¤€ ëª…ì‹œ í•„ìˆ˜

<br>

## í”„ë¡œì íŠ¸ íšŒê³ 

### âœ… ì„±ê³µ ìš”ì¸
1. **ì²´ê³„ì ì¸ í˜‘ì—…**: í•˜ë£¨ 2íšŒ ìŠ¤í¬ëŸ¼, GitHub Projects/Issues í™œìš©
2. **ì ì ˆí•œ ëª¨ë¸ ì„ íƒ**: ëŒ€í™” íŠ¹í™” ì‚¬ì „í•™ìŠµ ëª¨ë¸ í™œìš©
3. **ì²´ê³„ì ì¸ ì „ì²˜ë¦¬**: í™”ì í‘œê¸° ì •ê·œí™”, íŒ¨ë”© í† í° ë§ˆìŠ¤í‚¹
4. **ìƒì„± ì „ëµ ìµœì í™”**: Repetition controlì˜ ì„¬ì„¸í•œ ì¡°ì •
5. **ë°ì´í„° ì¦ê°•**: Solar API í™œìš©í•œ ì—­ë²ˆì—­ + í•„í„°ë§
6. **ë°ì€ ë¶„ìœ„ê¸°**: ì–´ë ¤ìš´ ìƒí™©ì—ì„œë„ ê¸ì •ì  íŒ€ ë¶„ìœ„ê¸° ìœ ì§€

### ğŸ”¥ ê°œì„  ê°€ëŠ¥ ì˜ì—­
1. **ì•™ìƒë¸” ì „ëµ**: ë‹¤ì¤‘ ëª¨ë¸ ì•™ìƒë¸” ì‹œë„ ë¶€ì¡±
2. **í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹**: Optuna ë“± ìë™í™” ë„êµ¬ ë¯¸í™œìš©
3. **í˜‘ì—… ê°•í™”**: ê°œì¸ ì‹¤í—˜ ìœ„ì£¼ë¡œ ì§„í–‰ë˜ì–´ í˜‘ì—… ë¶€ì¡±
4. **ì‹œê°„ ê´€ë¦¬**: ì¶”ì„ ì—°íœ´ í™œìš© ë¯¸í¡

### ğŸ“ˆ í•µì‹¬ êµí›ˆ
1. **Padding Token ì²˜ë¦¬**: Loss ê³„ì‚°ì—ì„œ íŒ¨ë”© ì œì™¸ëŠ” í•„ìˆ˜
2. **í‰ê°€ ì§€í‘œ ì´í•´**: ê¸°ìˆ ì  ìš°ìˆ˜ì„± â‰  í‰ê°€ ê¸°ì¤€ ë¶€í•©
3. **Seq2Seq vs Causal LM**: ìš”ì•½ íƒœìŠ¤í¬ëŠ” Seq2Seqê°€ ìœ ë¦¬
4. **API í™œìš©**: ì™¸ë¶€ LLM APIë¡œ ë°ì´í„° í’ˆì§ˆ ê°œì„  ê°€ëŠ¥
5. **ì‹¤í—˜ ì¶”ì **: ì²´ê³„ì ì¸ ë¡œê¹…ì´ ë””ë²„ê¹…ê³¼ ê°œì„ ì— ê²°ì •ì 

### ğŸ’¬ íŒ€ì› ì†Œê°

**ê¹€ì„ ë¯¼ (íŒ€ì¥)**
> NLPëŠ” ê¸°ì¡´ ê²½ì§„ëŒ€íšŒì™€ ì‚¬ë­‡ ë‹¤ë¥¸ ëŠë‚Œì´ì—ˆìŠµë‹ˆë‹¤. Config ì„¤ì •ê°’ë¶€í„° ì–¸ì–´í•™ ê°œë…ê¹Œì§€ ì—¬ëŸ¬ ì„ ìˆ˜ ì§€ì‹ì´ í•„ìš”í•˜ë‹¤ ë³´ë‹ˆ ì ì‘í•˜ëŠ” ë° ë§ì€ ì‹œê°„ì´ ê±¸ë ¸ìŠµë‹ˆë‹¤. ì„±ëŠ¥ë³´ë‹¤ëŠ” ê°œë…ê³¼ ì½”ë“œë¥¼ ì´í•´í•˜ëŠ” ë° ì§‘ì¤‘í–ˆê³ , ëª¨ë¸ êµ¬ì¡°ì™€ ë°ì´í„° íë¦„ì„ ì§ì ‘ ë¶„ì„í•˜ë©° NLP íŒŒì´í”„ë¼ì¸ì˜ ê¸°ë³¸ ì›ë¦¬ë¥¼ ë°°ì› ìŠµë‹ˆë‹¤.

**ê¹€ë³‘í˜„**
> ì‹ ë‚˜ê²Œ ì‹¤í—˜í•´ë´¤ìŠµë‹ˆë‹¤! ì¬ë°Œì—ˆìŠµë‹ˆë‹¤!

**ì„ì˜ˆìŠ¬**
> NLP ê²½ì§„ëŒ€íšŒê°€ í¥ë¯¸ë¡­ê¸°ë„ í•˜ë©´ì„œ ì´ì „ ëŒ€íšŒì™€ ë§ì´ ë‹¤ë¥´ë‹¤ê³  ëŠê¼ˆìŠµë‹ˆë‹¤. ì–´ë ¤ì› ì§€ë§Œ íŒ€ì›ë¶„ë“¤ê»˜ì„œ ì˜ ì´ëŒì–´ê°€ì£¼ì…”ì„œ ê°ì‚¬í•œ ì‹œê°„ì´ì—ˆìŠµë‹ˆë‹¤.

**ì •ì„œìš°**
> ì§€ê¸ˆê¹Œì§€ ì§„í–‰í•œ ê²½ì§„ëŒ€íšŒ ì¤‘ ê°€ì¥ ì–´ë ¤ì› ë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤. í•œë²ˆ ì‹œë„í•  ë•Œë§ˆë‹¤ ê±¸ë¦¬ëŠ” ì‹œê°„ë„ í›¨ì”¬ ê¸¸ë‹¤ ë³´ë‹ˆ ë¶€ë”ªí˜€ ê°€ë©´ì„œ ë°°ìš°ëŠ” ê²ƒë„ ì–´ë µê³ , ì ìˆ˜ê°€ ë§ˆìŒëŒ€ë¡œ ì˜ ë‚˜ì˜¤ì§€ ì•Šì„ ë•Œ íƒ€ê²©ë„ ì»¸ë˜ ê²ƒ ê°™ìŠµë‹ˆë‹¤. ì–¸ì œë‚˜ ë°ì€ ë¶„ìœ„ê¸°ì—ì„œ ë‹¤ í•¨ê»˜ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆì—ˆë˜ íŒ€ì›ë¶„ë“¤ ë•ë¶„ì— ëê¹Œì§€ í•  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤!

**ì •ì†Œí˜„**
> ë‘ë ¤ì›€ì„ ê°€ì§€ê³  ì‹œì‘í•œ ëŒ€íšŒì¸ë°, ëŒ€íšŒê°€ ëë‚˜ê³  ë‚˜ë‹ˆ ê¸°ì´ˆì— ë” ì§‘ì¤‘í•´ì•¼ í•˜ëŠ”êµ¬ë‚˜, ì‚¬ìš©í•˜ëŠ” í”Œë«í¼ì— ëŒ€í•œ ë” ê¹Šì€ ì´í•´ê°€ í•„ìˆ˜ì ì´êµ¬ë‚˜ í™•ì‹¤í•œ ëŸ¬ë‹ í¬ì¸íŠ¸ê°€ ìˆì—ˆë˜ ëŒ€íšŒì…ë‹ˆë‹¤.

**ìµœí˜„í™”**
> Optuna ìµœì í™”, K-Fold ì•™ìƒë¸”, Solar API ì—°ë™ ë“± ì „ì²´ ML íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ê²½í—˜ì„ ìŒ“ì•˜ìŠµë‹ˆë‹¤. ë¹„ë¡ ì ìˆ˜ëŠ” í¬ê²Œ ê¸°ì—¬í•˜ì§€ ëª»í–ˆì§€ë§Œ, ROUGE í‰ê°€ ë°©ì‹ê³¼ í™”ì íƒœê·¸ ìœ ì§€ì˜ ì¤‘ìš”ì„±ì„ ê¹Šì´ ì´í•´í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

<br>

## ì°¸ê³ ìë£Œ

### ëŒ€íšŒ ì •ë³´
- **ë°ì´í„°**: https://aistages-api-public-prod.s3.amazonaws.com/app/Competitions/000365/data/data.tar.gz
- **ë² ì´ìŠ¤ë¼ì¸**: https://aistages-api-public-prod.s3.amazonaws.com/app/Competitions/000365/data/code.tar.gz

### ì‚¬ìš© ëª¨ë¸
- [paust/pko-chat-t5-large](https://huggingface.co/paust/pko-chat-t5-large)
- [gogamza/kobart-base-v2](https://huggingface.co/gogamza/kobart-base-v2)
- [Solar-1-mini-chat API](https://upstage.ai/)

### ê¸°ìˆ  ë¬¸ì„œ
- [HuggingFace Transformers](https://huggingface.co/docs/transformers)
- [PyTorch Documentation](https://pytorch.org/docs/stable/index.html)
- [WandB Documentation](https://docs.wandb.ai/)
- [ROUGE Metric](https://huggingface.co/spaces/evaluate-metric/rouge)

### ë…¼ë¬¸
- [BART: Denoising Sequence-to-Sequence Pre-training](https://arxiv.org/abs/1910.13461)
- [LoRA: Low-Rank Adaptation of Large Language Models](https://arxiv.org/abs/2106.09685)
- [ROUGE: A Package for Automatic Evaluation](https://aclanthology.org/W04-1013/)

<br>

---

**Team 1SEN (ì¼ìˆ)** | Upstage AI Lab Dialogue Summarization | 3rd Place ğŸ¥‰
